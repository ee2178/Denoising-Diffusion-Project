  0%|          | 0/2678 [00:00<?, ?it/s]  1%|          | 23/2678 [00:00<00:11, 228.04it/s]  2%|▏         | 49/2678 [00:00<00:10, 245.90it/s]  3%|▎         | 75/2678 [00:00<00:10, 251.41it/s]  4%|▍         | 101/2678 [00:00<00:10, 252.39it/s]  5%|▍         | 128/2678 [00:00<00:09, 255.24it/s]  6%|▌         | 154/2678 [00:00<00:09, 252.53it/s]  7%|▋         | 182/2678 [00:00<00:09, 260.80it/s]  8%|▊         | 210/2678 [00:00<00:09, 264.93it/s]  9%|▉         | 237/2678 [00:00<00:09, 246.82it/s] 10%|▉         | 262/2678 [00:01<00:10, 239.58it/s] 11%|█         | 288/2678 [00:01<00:09, 245.22it/s] 12%|█▏        | 313/2678 [00:01<00:09, 245.98it/s] 13%|█▎        | 340/2678 [00:01<00:09, 252.66it/s] 14%|█▎        | 367/2678 [00:01<00:09, 256.52it/s] 15%|█▍        | 394/2678 [00:01<00:08, 258.16it/s] 16%|█▌        | 420/2678 [00:01<00:08, 257.99it/s] 17%|█▋        | 446/2678 [00:01<00:08, 253.76it/s] 18%|█▊        | 472/2678 [00:01<00:08, 250.64it/s] 19%|█▊        | 498/2678 [00:01<00:09, 240.63it/s] 20%|█▉        | 523/2678 [00:02<00:09, 228.82it/s] 20%|██        | 547/2678 [00:02<00:09, 229.92it/s] 21%|██▏       | 572/2678 [00:02<00:08, 234.60it/s] 22%|██▏       | 600/2678 [00:02<00:08, 246.51it/s] 23%|██▎       | 626/2678 [00:02<00:08, 247.79it/s] 24%|██▍       | 652/2678 [00:02<00:08, 249.73it/s] 25%|██▌       | 679/2678 [00:02<00:07, 254.55it/s] 26%|██▋       | 706/2678 [00:02<00:07, 257.84it/s] 27%|██▋       | 732/2678 [00:02<00:07, 256.08it/s] 28%|██▊       | 759/2678 [00:03<00:07, 258.26it/s] 29%|██▉       | 785/2678 [00:03<00:07, 258.14it/s] 30%|███       | 811/2678 [00:03<00:07, 250.92it/s] 31%|███▏      | 837/2678 [00:03<00:07, 246.95it/s] 32%|███▏      | 862/2678 [00:03<00:07, 241.12it/s] 33%|███▎      | 887/2678 [00:03<00:07, 227.71it/s] 34%|███▍      | 912/2678 [00:03<00:07, 231.64it/s] 35%|███▌      | 939/2678 [00:03<00:07, 240.39it/s] 36%|███▌      | 964/2678 [00:03<00:07, 236.71it/s] 37%|███▋      | 988/2678 [00:04<00:07, 227.47it/s] 38%|███▊      | 1011/2678 [00:04<00:07, 214.94it/s] 39%|███▊      | 1033/2678 [00:04<00:08, 194.15it/s] 39%|███▉      | 1054/2678 [00:04<00:08, 196.52it/s] 40%|████      | 1076/2678 [00:04<00:07, 201.55it/s] 41%|████      | 1103/2678 [00:04<00:07, 219.63it/s] 42%|████▏     | 1126/2678 [00:04<00:07, 211.37it/s] 43%|████▎     | 1152/2678 [00:04<00:06, 224.14it/s] 44%|████▍     | 1175/2678 [00:04<00:06, 216.40it/s] 45%|████▍     | 1200/2678 [00:05<00:06, 224.10it/s] 46%|████▌     | 1225/2678 [00:05<00:06, 230.64it/s] 47%|████▋     | 1251/2678 [00:05<00:06, 236.94it/s] 48%|████▊     | 1278/2678 [00:05<00:05, 245.62it/s] 49%|████▊     | 1304/2678 [00:05<00:05, 248.00it/s] 50%|████▉     | 1329/2678 [00:05<00:05, 247.23it/s] 51%|█████     | 1355/2678 [00:05<00:05, 248.14it/s] 52%|█████▏    | 1380/2678 [00:05<00:05, 241.16it/s] 52%|█████▏    | 1405/2678 [00:05<00:05, 225.68it/s] 53%|█████▎    | 1432/2678 [00:05<00:05, 237.43it/s] 54%|█████▍    | 1456/2678 [00:06<00:05, 230.67it/s] 55%|█████▌    | 1480/2678 [00:06<00:05, 231.70it/s] 56%|█████▌    | 1505/2678 [00:06<00:04, 236.20it/s] 57%|█████▋    | 1533/2678 [00:06<00:04, 247.20it/s] 58%|█████▊    | 1560/2678 [00:06<00:04, 252.05it/s] 59%|█████▉    | 1587/2678 [00:06<00:04, 254.94it/s] 60%|██████    | 1613/2678 [00:06<00:04, 253.20it/s] 61%|██████    | 1640/2678 [00:06<00:04, 255.36it/s] 62%|██████▏   | 1666/2678 [00:06<00:04, 247.29it/s] 63%|██████▎   | 1691/2678 [00:07<00:04, 241.45it/s] 64%|██████▍   | 1716/2678 [00:07<00:04, 235.04it/s] 65%|██████▌   | 1742/2678 [00:07<00:03, 241.43it/s] 66%|██████▌   | 1767/2678 [00:07<00:03, 238.71it/s] 67%|██████▋   | 1793/2678 [00:07<00:03, 243.65it/s] 68%|██████▊   | 1819/2678 [00:07<00:03, 247.55it/s] 69%|██████▉   | 1845/2678 [00:07<00:03, 250.58it/s] 70%|██████▉   | 1871/2678 [00:07<00:03, 249.28it/s] 71%|███████   | 1896/2678 [00:07<00:03, 248.12it/s] 72%|███████▏  | 1923/2678 [00:07<00:02, 253.48it/s] 73%|███████▎  | 1950/2678 [00:08<00:02, 257.70it/s] 74%|███████▍  | 1976/2678 [00:08<00:02, 256.04it/s] 75%|███████▍  | 2002/2678 [00:08<00:02, 245.64it/s] 76%|███████▌  | 2028/2678 [00:08<00:02, 246.86it/s] 77%|███████▋  | 2053/2678 [00:08<00:02, 234.99it/s] 78%|███████▊  | 2077/2678 [00:08<00:02, 233.97it/s] 78%|███████▊  | 2101/2678 [00:08<00:02, 232.62it/s] 79%|███████▉  | 2126/2678 [00:08<00:02, 236.32it/s] 80%|████████  | 2152/2678 [00:08<00:02, 241.86it/s] 81%|████████▏ | 2179/2678 [00:09<00:02, 248.17it/s] 82%|████████▏ | 2206/2678 [00:09<00:01, 253.54it/s] 83%|████████▎ | 2233/2678 [00:09<00:01, 256.09it/s] 84%|████████▍ | 2260/2678 [00:09<00:01, 258.59it/s] 85%|████████▌ | 2287/2678 [00:09<00:01, 260.71it/s] 86%|████████▋ | 2314/2678 [00:09<00:01, 262.64it/s] 87%|████████▋ | 2341/2678 [00:09<00:01, 258.36it/s] 88%|████████▊ | 2368/2678 [00:09<00:01, 260.66it/s] 89%|████████▉ | 2395/2678 [00:09<00:01, 259.50it/s] 90%|█████████ | 2422/2678 [00:09<00:00, 260.34it/s] 91%|█████████▏| 2449/2678 [00:10<00:00, 261.97it/s] 92%|█████████▏| 2476/2678 [00:10<00:00, 255.84it/s] 93%|█████████▎| 2502/2678 [00:10<00:00, 255.01it/s] 94%|█████████▍| 2528/2678 [00:10<00:00, 249.95it/s] 95%|█████████▌| 2554/2678 [00:10<00:00, 246.49it/s] 96%|█████████▋| 2580/2678 [00:10<00:00, 248.91it/s] 97%|█████████▋| 2605/2678 [00:10<00:00, 246.57it/s] 98%|█████████▊| 2631/2678 [00:10<00:00, 248.71it/s] 99%|█████████▉| 2657/2678 [00:10<00:00, 250.64it/s]100%|██████████| 2678/2678 [00:10<00:00, 243.89it/s]
  0%|          | 0/815 [00:00<?, ?it/s]  3%|▎         | 27/815 [00:00<00:02, 269.50it/s]  7%|▋         | 54/815 [00:00<00:02, 267.21it/s] 10%|▉         | 81/815 [00:00<00:02, 264.67it/s] 13%|█▎        | 108/815 [00:00<00:02, 264.85it/s] 17%|█▋        | 135/815 [00:00<00:02, 259.84it/s] 20%|█▉        | 162/815 [00:00<00:02, 257.27it/s] 23%|██▎       | 188/815 [00:00<00:02, 246.28it/s] 26%|██▋       | 214/815 [00:00<00:02, 248.94it/s] 29%|██▉       | 240/815 [00:00<00:02, 252.00it/s] 33%|███▎      | 266/815 [00:01<00:02, 247.78it/s] 36%|███▌      | 291/815 [00:01<00:02, 236.61it/s] 39%|███▉      | 317/815 [00:01<00:02, 243.22it/s] 42%|████▏     | 343/815 [00:01<00:01, 247.64it/s] 45%|████▌     | 369/815 [00:01<00:01, 250.08it/s] 49%|████▊     | 397/815 [00:01<00:01, 256.21it/s] 52%|█████▏    | 423/815 [00:01<00:01, 257.04it/s] 55%|█████▌    | 449/815 [00:01<00:01, 255.37it/s] 58%|█████▊    | 475/815 [00:01<00:01, 256.04it/s] 62%|██████▏   | 502/815 [00:01<00:01, 257.57it/s] 65%|██████▍   | 528/815 [00:02<00:01, 256.52it/s] 68%|██████▊   | 555/815 [00:02<00:01, 259.92it/s] 71%|███████▏  | 582/815 [00:02<00:00, 252.39it/s] 75%|███████▍  | 608/815 [00:02<00:00, 250.92it/s] 78%|███████▊  | 634/815 [00:02<00:00, 251.89it/s] 81%|████████  | 660/815 [00:02<00:00, 248.82it/s] 84%|████████▍ | 688/815 [00:02<00:00, 255.95it/s] 88%|████████▊ | 714/815 [00:02<00:00, 249.74it/s] 91%|█████████ | 740/815 [00:02<00:00, 240.44it/s] 94%|█████████▍| 765/815 [00:03<00:00, 241.31it/s] 97%|█████████▋| 790/815 [00:03<00:00, 228.42it/s]100%|█████████▉| 814/815 [00:03<00:00, 231.29it/s]100%|██████████| 815/815 [00:03<00:00, 249.16it/s]
  0%|          | 0/322 [00:00<?, ?it/s]  8%|▊         | 26/322 [00:00<00:01, 255.80it/s] 16%|█▌        | 52/322 [00:00<00:01, 235.86it/s] 24%|██▎       | 76/322 [00:00<00:01, 233.35it/s] 31%|███▏      | 101/322 [00:00<00:00, 236.46it/s] 39%|███▉      | 125/322 [00:00<00:00, 236.59it/s] 47%|████▋     | 150/322 [00:00<00:00, 239.22it/s] 54%|█████▍    | 175/322 [00:00<00:00, 240.32it/s] 62%|██████▏   | 201/322 [00:00<00:00, 244.57it/s] 70%|███████   | 226/322 [00:00<00:00, 244.20it/s] 78%|███████▊  | 251/322 [00:01<00:00, 244.61it/s] 86%|████████▌ | 276/322 [00:01<00:00, 238.85it/s] 93%|█████████▎| 301/322 [00:01<00:00, 241.27it/s]100%|██████████| 322/322 [00:01<00:00, 240.80it/s]
TRAIN-E1:   0%|          | 0/267 [00:00<?, ?it/s]TRAIN-E1:   0%|          | 0/267 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/vast/ee2178/Denoising-Diffusion-Project/my_CDLNet/train.py", line 273, in <module>
    main(args)    
  File "/vast/ee2178/Denoising-Diffusion-Project/my_CDLNet/train.py", line 22, in main
    fit(net, 
  File "/vast/ee2178/Denoising-Diffusion-Project/my_CDLNet/train.py", line 90, in fit
    batch_hat, _ = net(obsrv_batch, sigma_n, mask=mask)
  File "/vast/ee2178/miniconda3/envs/env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vast/ee2178/Denoising-Diffusion-Project/my_CDLNet/model.py", line 131, in forward
    print(self.B[1](z).shape)
UnboundLocalError: local variable 'z' referenced before assignment
